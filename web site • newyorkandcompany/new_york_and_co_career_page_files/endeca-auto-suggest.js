(function(d){var a=function(f,g,h){if(f!=null&&g!=null&&f.attributes!=null&&f.attributes[g]!=null){return f.attributes[g][0]}return(typeof(h)==="undefined"?null:h)};var e=function(){var f=window.location.pathname;var g=null;if(f.endsWith("search")){g=f.split("/search")[0]}else{if(f.endsWith("browse")){g=f.split("/browse")[0]}else{if(f.endsWith("browse/")){g=f.split("browse/")[0]}else{if(f.endsWith("search/")){g=f.split("search/")[0]}else{g=f}}}}return g};String.prototype.endsWith=function(f){var g=this.length-f.length;return g>=0&&this.lastIndexOf(f)===g};var c=0;d("#atg_store_searchInput").live("keypress",function(g){var f=(g.keyCode?g.keyCode:g.which);if((f!=37)&&(f!=38)&&(f!=39)&&(f!=40)&&(f!=13)){d(".dimSearchSuggContainer").html("")}});d(document).keypress(function(f){});d(".quick_order_search").find(".dimResult a").live("click",function(){var f=d(this).find(".ProductDetails").text();d(quicksearchlocation).val(f);d(".quick_order_search").hide()});d.EndecaSearchSuggestor=function(h,g){this._active=true;this._options=g;this._lastValue="";this._element=h;this._container=d('<div class="'+this._options.containerClass+'"></>');this._timeOutId;this._hideTimeOutId;this._selectedIndex=-1;var f=this;d("body").append(this._container);h.keydown(function(i){console.log("e.keyCode:"+i.keyCode);switch(i.keyCode){case 38:if(f._active){f.moveToPrev()}else{f.show()}break;case 40:if(f._active){f.moveToNext();i.preventDefault()}else{f.show()}break;case 9:f.hide();break;case 13:if(f._active&&f._selectedIndex!=-1){i.preventDefault();f.selectItem();return false}b(i);break;case 27:if(f._active){f.hide()}break;default:console.log("handleRequest");f.handleRequest()}});h.blur(function(i){var k=function(){f.hide()};f._hideTimeOutId=setTimeout(k,200)})};function b(g){g.preventDefault();var f=d("input#searchText").val().replace(/[</>>&%]/g,"");f=d.trim(f).replaceAll(" ","+");f=f.replaceAll("-","+");f=f.replaceAll("\\.","+");f=f.replace(/[^A-Za-z0-9+?%.)(/\]]/g,"");f=f.replace(/[+]{2,}/g,"+");f=f.replace(/[-]{2,}/g,"-");f=f.toLowerCase();var h=d("#applicationPath").val()+"/search/?Dy=1&Nty=1&Ntp=1&Ntt="+f;d.post(d("#applicationPath").val()+"/cartridges/SearchBox/includes/resultRedirection.jsp?Dy=1&Ntp=1&Nty=1&Ntt="+escape(f),{searchTerm:f},function(i){h=d("#applicationPath").val()+i.processedURI;window.location=h})}d.EndecaSearchSuggestor.prototype.moveToPrev=function(){if(this._selectedIndex==-1){this._selectedIndex=0}else{if(this._selectedIndex==0){return}this._selectedIndex--}d(".dimResult").removeClass("selected");d(d(".dimResult").get(this._selectedIndex)).addClass("selected");if(this._selectedIndex<=4){d(".dimSearchSuggContainer").scrollTop(d(".dimSearchSuggContainer").scrollTop()-60)}};d.EndecaSearchSuggestor.prototype.moveToNext=function(){if(this._selectedIndex==-1){this._selectedIndex=0}else{if(this._selectedIndex==d(".dimResult").size()-1){return}this._selectedIndex++}d(".dimResult").removeClass("selected");d(d(".dimResult").get(this._selectedIndex)).addClass("selected");if(this._selectedIndex>=5){d(".dimSearchSuggContainer").scrollTop(d(".dimSearchSuggContainer").scrollTop()+60)}};d.EndecaSearchSuggestor.prototype.selectItem=function(){if(this._selectedIndex==-1){return}var h=d("#searchText").val();var g=d("a",d("#dim_serch_cont").get(this._selectedIndex)).attr("href");var f=g.includes("/");if(f==false){g="search/?Ntp=1&Nty=1&Dy=1&Ntt="+d.trim(h);document.location.href=g}else{document.location.href=g}};d.EndecaSearchSuggestor.prototype.hide=function(){this._container.hide();this._active=false};d.EndecaSearchSuggestor.prototype.show=function(){if(this._container.is(":hidden")){this.setPosition();this._container.show();this._active=true;this._selectedIndex=-1}};d.EndecaSearchSuggestor.prototype.handleRequest=function(){var f=this;var g=function(){var k=d.trim(f._element.val());var h=f._element.val();var i=h.length!=f._lastValue.length&&f._lastValue===d.trim(h)?true:false;if(k!=f._lastValue||i){d("#dim_serch_cont").html("");d("#dim_serch_cont").hide();if(k.length>=f._options.minAutoSuggestInputLength){console.log("requestData");f.requestData()}else{f.hide();d("#dim_serch_cont").html("")}}f._lastValue=k};if(this._timeOutId){clearTimeout(this._timeOutId)}this._timeOutId=setTimeout(g,this._options.delay)};d.EndecaSearchSuggestor.prototype.requestData=function(){d("#dim_serch_cont").html("");var g=this;var f=d.ajax({url:g.composeUrl(),dataType:"json",async:true,success:function(h){console.log("data:"+h);d("#dim_serch_cont").html("");g.showSearchResult(h)}})};d.EndecaSearchSuggestor.prototype.composeUrl=function(){var g=this._options.autoSuggestServiceUrl;var f=d.trim(this._element.val());if(g.indexOf("?")==-1){g+="?"}else{g+="&"}g+="Dy=1&collection="+this._options.collection+"&Ntk=AutoSuggest&Ntt="+escape(f)+"*";g+="&Ntx=mode+matchpartialmax";return g};d.EndecaSearchSuggestor.prototype.showSearchResult=function(g){var f=this.processSearchResult(g);console.log("htmlResult:"+f);if(f!=null){d("#dim_serch_cont").show()}else{d("#dim_serch_cont").hide()}};d.EndecaSearchSuggestor.prototype.processSearchResult=function(x){var i=null;var t=null;jQuery.each(x,function(y,z){console.log("name: "+y+",value: "+z)});var p=x.contents[0].autoSuggest;if(p==null||p.length==0){return null}var r=null;var l="";var g=0;var v=null;var w=8;var f=0;for(var q=0;q<p.length;q++){var o=p[q];if(o["@type"]=="DimensionSearchAutoSuggestItem"){i=o;if(i!=null){r=this.generateHtmlContent(i);if(i.dimensionSearchGroups[0]!=undefined){f=i.dimensionSearchGroups[0].dimensionSearchValues.length}}}if(o["@type"]=="RecordSearchAutoSuggestItem"){var n=null;var m=this;var k=null;var u=e();t=o;if(t!=null&&t.records!=null&&t.records.length>0){var h=o["@type"];k=d("<div/>").addClass(h);if(t.title){}var s="";w=t.defaultRecsPerPage;v=w-f;d.each(t.records,function(H,F){g=H;if(H<v){if(u.endsWith("/")){n=F.detailsAction.contentPath.split("/")[1]}else{n=F.detailsAction.contentPath}var E=u+n+F.detailsAction.recordState;var D=d("<a class='AutoSuggestRecord clearfix'/>").attr("href",E).appendTo(k);if(typeof(m._options.select)==="function"){D.click(function(P){P.preventDefault();m._options.select.call(m,m._element,F)})}var M=d("<div class='AutoSuggestRecordInfo'/>").appendTo(D);var L=a(F,"product.displayName","");if(s===L){}else{s=L;var K=a(F,"product.repositoryId","");var I=a(F,"product.CategoryId","");M.append(d("<div class='ProductName'/>").html(a(F,"product.displayName","")));var G=a(F,"product.productCode","");var N=a(F,"currNavState","");d("<div class='ProductDetails'/>").text(G).appendTo(M);var C=L.replaceAll("&","+");var A=d.trim(L).replaceAll(" ","+");A=A.replaceAll("-","+");A=A.replaceAll("&","");A=A.replaceAll("\\.","+");A=A.replace(/[^A-Za-z0-9+?%.)(/\]]/g,"");A=A.replace(/[+]{2,}/g,"+");A=A.replace(/[-]{2,}/g,"-");A=A.toLowerCase();var z=L;z=z.replaceAll("\\'","");z=z.replaceAll('\\"',"");var J=d("#applicationPath").val()+"/search/?Dy=1&Nty=1&Ntp=1&Ntk=product.displayName&Ntt="+escape(A);C=C.replace("'","");var B=d("#searchText").val();var O=('<a href="javascript:void(0)" onclick="selectTypeAhead(\''+A+"','"+z.toLowerCase()+"')\">"+d.EndecaSearchSuggestor.prototype.highlightMatched(L)+"</a>");var y=d("#dim_serch_cont").attr("id");l+=O}}})}}}if(r!=null&&r!=""){if(v!=null){d.each(d(r).find("a"),function(A,y){if(A<w){var z=d("<p></p>").append(d(y));d("#dim_serch_cont").append(z)}})}else{d("#dim_serch_cont").append(r)}}if(l!=""){d("#dim_serch_cont").append(l)}d("#dim_serch_cont").show();if(r!=""||l!=""){return r+l}return null};d.EndecaSearchSuggestor.prototype.generateHtmlContent=function(k){var x=null;var A=d("#searchText").val();if(k!=null&&k.dimensionSearchGroups!=null&&k.dimensionSearchGroups.length>0){x=d("<p></p>");if(k.title&&d.trim(k.title)!=""){}var w=k.dimensionSearchGroups;var y="";for(var v=0;v<w.length;v++){var D=w[v];var g=D.displayName;for(var s=0;s<D.dimensionSearchValues.length;s++){var l=D.dimensionSearchValues[s];var r=l.navigationState;var z=d("#topLevelDimvals").val();z=z.slice(1,z.length-1).split(",");var u=false;for(var v=0;v<z.length;v++){if(d.trim(z[v])===r.split("N-")[1]){u=true;console.log("dimvalId--"+z[v])}}if(u){continue}if(l.label!="Commerce Root"){var p=l.label;var m=d.trim(p).replaceAll(" ","+");m=m.replaceAll("&","");m=m.replaceAll("-","+");m=m.replace(/[^A-Za-z0-9+?%.)(/\]]/g,"-");m=m.replace(/[+]{2,}/g,"+");m=m.replace(/[-]{2,}/g,"-");m=m.toLowerCase();var o=p;o=o.replaceAll("\\'","");o=o.replaceAll('\\"',"")}var f=l.ancestors;var C="";if(f!=null&&f.length>0){if(y.indexOf(l.properties["category.repositoryId"])>-1){continue}y+=l.properties["category.repositoryId"]+"-";for(var q=f.length-1;q>0;q--){if(q>1){C+=f[q].label+" In "}else{C+=f[q].label}}if(k.displayImage){var B="";var h=l.count==null?"":"&nbsp;("+l.count+")";if(d.trim(l.properties.img_url_thumbnail)!=""){B=l.properties.img_url_thumbnail}else{B=this._options.defaultImage}if(f.length>1){if(r.split("/look/").length===2){var t=r.split("N-")[1];t=t.split("?_=")[0];t="'look/N-"+t+"'";x.append('<a href="javascript:void(0);" onclick="openLook('+t+')">'+this.highlightMatched(p)+"</a>"+h)}else{x.append('<a href="javascript:void(0)" onclick="selectTypeAhead(\''+m+"','"+o.toLowerCase()+"')\">"+this.highlightMatched(p)+"</a>"+h)}}else{if(!u){x.append('<a href="javascript:void(0)" onclick="selectTypeAhead(\''+m+"','"+o.toLowerCase()+"')\">"+this.highlightMatched(p)+C+"</a>"+h)}}}else{if(f.length>1){x.append('<a href="javascript:void(0)" onclick="selectTypeAhead(\''+m+"','"+o.toLowerCase()+"')\">"+this.highlightMatched(p)+"</a>"+h)}else{if(!u){x.append('<a href="javascript:void(0)" onclick="selectTypeAhead(\''+m+"','"+o.toLowerCase()+"')\">"+this.highlightMatched(p)+C+"</a>"+h)}}}}}}}if(d(x).find("a")===undefined||d(x).find("a").length==0){x=""}return x};d.EndecaSearchSuggestor.prototype.highlightMatched=function(i){var h="";if(this._element!=undefined){h=d.trim(this._element.val()).toLowerCase()}else{h=d.trim(d("#searchText").val()).toLowerCase()}var g=i.toLowerCase();var f=h.split(" ");for(j=0;j<f.length;j++){if(g.toLowerCase().indexOf(f[j].toLowerCase())!=-1){var g=g.toLowerCase().replace(new RegExp(f[j].toLowerCase(),"g"),"{"+f[j].toLowerCase()+"}")}}g=g.toLowerCase().replace(new RegExp("{","g"),"<span>");g=g.toLowerCase().replace(new RegExp("}","g"),"</span>");return g};d.EndecaSearchSuggestor.prototype.bindEventHandler=function(){var f=this;d(".dimResult",this._container).mouseover(function(g){d(".dimResult",f._container).removeClass("selected");d(this).addClass("selected");f._selectedIndex=d(".dimResult",f._container).index(d(this))});d(".dimResult",this._container).click(function(g){f.selectItem()});d("a",d(".dimResult",this._container)).click(function(g){g.preventDefault();f.selectItem()});d(".dimRoots",this._container).click(function(){clearTimeout(f._hideTimeOutId);f._element.focus()})};d.EndecaSearchSuggestor.prototype.setPosition=function(){var f=this._element.offset();this._container.css({top:f.top+this._element.outerHeight(),left:f.left,width:this._element.width()})};d.fn.endecaSearchSuggest=function(f){var g=d.extend({},d.fn.endecaSearchSuggest.defaults,f);this.each(function(){var h=d(this);new d.EndecaSearchSuggestor(h,g)})};d.fn.endecaSearchSuggest.defaults={minAutoSuggestInputLength:3,displayImage:false,delay:250,autoSuggestServiceUrl:"",collection:"",searchUrl:"",containerClass:"dimSearchSuggContainer",defaultImage:"no_image.gif"};d("#searchText").endecaSearchSuggest({minAutoSuggestInputLength:3,collection:"/content/NYCO/SearchSuggestion",autoSuggestServiceUrl:"/global/typeAhead.jsp",searchUrl:"",containerClass:"dimSearchSuggContainer",defaultImage:'<c:url value="/images/no_image_auto_suggest.gif"/>'})})(jQuery);function selectTypeAhead(a,c){a=a.replace(/[</>>&%]/g,"");a=a.replaceAll(" ","+");a=a.replaceAll("-","+");a=a.replaceAll("&","");a=a.replaceAll("\\.","+");a=a.replace(/[^A-Za-z0-9+?%.)(/\]]/g,"");a=a.replace(/[+]{2,}/g,"+");a=a.replace(/[-]{2,}/g,"-");a=a.toLowerCase();a=escape(a);var b=$("#applicationPath").val()+"/search/?Dy=1&Nty=1&Ntp=1&Ntt="+a;$.post($("#applicationPath").val()+"/cartridges/SearchBox/includes/resultRedirection.jsp?Dy=1&Ntp=1&Nty=1&Ntt="+a,{searchTerm:a},function(d){b=$("#applicationPath").val()+d.processedURI;if(b.indexOf("/N-")>-1){window.location=b+"?searchTerm="+escape(c)}else{if(b.indexOf("/A-")>-1){window.location=b+"?search=true&searchTerm="+escape(c)}else{window.location=b}}})};